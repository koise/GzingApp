<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logs API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1, h2 {
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .response {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin-top: 15px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
        }
        .success {
            border-color: #28a745;
            background-color: #d4edda;
        }
        .error {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>üìä Logs API Test</h1>
    
    <div class="grid">
        <!-- Create Log Section -->
        <div class="container">
            <h2>üìù Create Log</h2>
            <form id="createLogForm">
                <div class="form-group">
                    <label for="logType">Log Type:</label>
                    <select id="logType" name="logType" onchange="toggleLogTypeFields()">
                        <option value="navigation">Navigation Log</option>
                        <option value="user_activity">User Activity Log</option>
                    </select>
                </div>
                
                <!-- Navigation Log Fields -->
                <div id="navigationFields">
                    <div class="form-group">
                        <label for="activityType">Activity Type:</label>
                        <select id="activityType" name="activityType">
                            <option value="navigation_start">Navigation Start</option>
                            <option value="navigation_stop">Navigation Stop</option>
                            <option value="navigation_pause">Navigation Pause</option>
                            <option value="navigation_resume">Navigation Resume</option>
                            <option value="route_change">Route Change</option>
                            <option value="destination_reached">Destination Reached</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="startLatitude">Start Latitude:</label>
                        <input type="number" id="startLatitude" name="startLatitude" step="any" placeholder="14.5995">
                    </div>
                    
                    <div class="form-group">
                        <label for="startLongitude">Start Longitude:</label>
                        <input type="number" id="startLongitude" name="startLongitude" step="any" placeholder="120.9842">
                    </div>
                    
                    <div class="form-group">
                        <label for="endLatitude">End Latitude:</label>
                        <input type="number" id="endLatitude" name="endLatitude" step="any" placeholder="14.6042">
                    </div>
                    
                    <div class="form-group">
                        <label for="endLongitude">End Longitude:</label>
                        <input type="number" id="endLongitude" name="endLongitude" step="any" placeholder="120.9822">
                    </div>
                    
                    <div class="form-group">
                        <label for="destinationName">Destination Name:</label>
                        <input type="text" id="destinationName" name="destinationName" placeholder="SM Mall of Asia">
                    </div>
                    
                    <div class="form-group">
                        <label for="destinationAddress">Destination Address:</label>
                        <input type="text" id="destinationAddress" name="destinationAddress" placeholder="Seaside Blvd, Pasay, Metro Manila">
                    </div>
                    
                    <div class="form-group">
                        <label for="routeDistance">Route Distance (km):</label>
                        <input type="number" id="routeDistance" name="routeDistance" step="0.01" placeholder="5.2">
                    </div>
                    
                    <div class="form-group">
                        <label for="estimatedDuration">Estimated Duration (minutes):</label>
                        <input type="number" id="estimatedDuration" name="estimatedDuration" placeholder="15">
                    </div>
                    
                    <div class="form-group">
                        <label for="transportMode">Transport Mode:</label>
                        <select id="transportMode" name="transportMode">
                            <option value="driving">Driving</option>
                            <option value="walking">Walking</option>
                            <option value="cycling">Cycling</option>
                            <option value="transit">Transit</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="navigationDuration">Navigation Duration (minutes):</label>
                        <input type="number" id="navigationDuration" name="navigationDuration" placeholder="12">
                    </div>
                    
                    <div class="form-group">
                        <label for="routeInstructions">Route Instructions:</label>
                        <textarea id="routeInstructions" name="routeInstructions" placeholder="Turn left at the next intersection..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="destinationReached">Destination Reached:</label>
                        <select id="destinationReached" name="destinationReached">
                            <option value="false">No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                </div>
                
                <!-- User Activity Log Fields -->
                <div id="userActivityFields" style="display: none;">
                    <div class="form-group">
                        <label for="logTypeActivity">Log Type Activity:</label>
                        <select id="logTypeActivity" name="logTypeActivity">
                            <option value="user_login">User Login</option>
                            <option value="user_logout">User Logout</option>
                            <option value="user_create">User Create</option>
                            <option value="user_update">User Update</option>
                            <option value="user_delete">User Delete</option>
                            <option value="page_access">Page Access</option>
                            <option value="api_call">API Call</option>
                            <option value="error_occurred">Error Occurred</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="logLevel">Log Level:</label>
                        <select id="logLevel" name="logLevel">
                            <option value="info">Info</option>
                            <option value="warning">Warning</option>
                            <option value="error">Error</option>
                            <option value="debug">Debug</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="action">Action:</label>
                        <input type="text" id="action" name="action" placeholder="User logged in successfully">
                    </div>
                    
                    <div class="form-group">
                        <label for="message">Message:</label>
                        <textarea id="message" name="message" placeholder="Detailed message about the action..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="userAgent">User Agent:</label>
                        <input type="text" id="userAgent" name="userAgent" placeholder="Mozilla/5.0...">
                    </div>
                </div>
                
                <!-- Common Fields -->
                <div class="form-group">
                    <label for="deviceInfo">Device Info:</label>
                    <input type="text" id="deviceInfo" name="deviceInfo" placeholder="Samsung Galaxy S21">
                </div>
                
                <div class="form-group">
                    <label for="appVersion">App Version:</label>
                    <input type="text" id="appVersion" name="appVersion" placeholder="1.0.0">
                </div>
                
                <div class="form-group">
                    <label for="osVersion">OS Version:</label>
                    <input type="text" id="osVersion" name="osVersion" placeholder="Android 12">
                </div>
                
                <div class="form-group">
                    <label for="additionalData">Additional Data (JSON):</label>
                    <textarea id="additionalData" name="additionalData" placeholder='{"key": "value"}'></textarea>
                </div>
                
                <div class="form-group">
                    <label for="errorMessage">Error Message:</label>
                    <input type="text" id="errorMessage" name="errorMessage" placeholder="Error details if any">
                </div>
                
                <button type="submit">Create Log</button>
            </form>
            
            <div id="createResponse" class="response" style="display: none;"></div>
        </div>
        
        <!-- Get Logs Section -->
        <div class="container">
            <h2>üìã Get Logs</h2>
            <form id="getLogsForm">
                <div class="form-group">
                    <label for="getLogType">Log Type:</label>
                    <select id="getLogType" name="getLogType">
                        <option value="all">All Logs</option>
                        <option value="navigation">Navigation Logs</option>
                        <option value="user_activity">User Activity Logs</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="page">Page:</label>
                    <input type="number" id="page" name="page" value="1" min="1">
                </div>
                
                <div class="form-group">
                    <label for="limit">Limit:</label>
                    <input type="number" id="limit" name="limit" value="20" min="1" max="100">
                </div>
                
                <div class="form-group">
                    <label for="dateFrom">Date From (YYYY-MM-DD):</label>
                    <input type="date" id="dateFrom" name="dateFrom">
                </div>
                
                <div class="form-group">
                    <label for="dateTo">Date To (YYYY-MM-DD):</label>
                    <input type="date" id="dateTo" name="dateTo">
                </div>
                
                <!-- Navigation-specific filters -->
                <div id="navigationFilters">
                    <div class="form-group">
                        <label for="filterActivityType">Activity Type:</label>
                        <select id="filterActivityType" name="filterActivityType">
                            <option value="">All</option>
                            <option value="navigation_start">Navigation Start</option>
                            <option value="navigation_stop">Navigation Stop</option>
                            <option value="navigation_pause">Navigation Pause</option>
                            <option value="navigation_resume">Navigation Resume</option>
                            <option value="route_change">Route Change</option>
                            <option value="destination_reached">Destination Reached</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="filterTransportMode">Transport Mode:</label>
                        <select id="filterTransportMode" name="filterTransportMode">
                            <option value="">All</option>
                            <option value="driving">Driving</option>
                            <option value="walking">Walking</option>
                            <option value="cycling">Cycling</option>
                            <option value="transit">Transit</option>
                        </select>
                    </div>
                </div>
                
                <!-- User activity-specific filters -->
                <div id="userActivityFilters" style="display: none;">
                    <div class="form-group">
                        <label for="filterLogTypeActivity">Log Type Activity:</label>
                        <select id="filterLogTypeActivity" name="filterLogTypeActivity">
                            <option value="">All</option>
                            <option value="user_login">User Login</option>
                            <option value="user_logout">User Logout</option>
                            <option value="user_create">User Create</option>
                            <option value="user_update">User Update</option>
                            <option value="user_delete">User Delete</option>
                            <option value="page_access">Page Access</option>
                            <option value="api_call">API Call</option>
                            <option value="error_occurred">Error Occurred</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="filterLogLevel">Log Level:</label>
                        <select id="filterLogLevel" name="filterLogLevel">
                            <option value="">All</option>
                            <option value="info">Info</option>
                            <option value="warning">Warning</option>
                            <option value="error">Error</option>
                            <option value="debug">Debug</option>
                        </select>
                    </div>
                </div>
                
                <button type="submit">Get Logs</button>
            </form>
            
            <div id="getResponse" class="response" style="display: none;"></div>
        </div>
    </div>
    
    <script>
        const API_BASE = window.location.origin + '/mobile-api/logs';
        
        // Toggle fields based on log type
        function toggleLogTypeFields() {
            const logType = document.getElementById('logType').value;
            const navFields = document.getElementById('navigationFields');
            const userFields = document.getElementById('userActivityFields');
            
            if (logType === 'navigation') {
                navFields.style.display = 'block';
                userFields.style.display = 'none';
            } else {
                navFields.style.display = 'none';
                userFields.style.display = 'block';
            }
        }
        
        // Toggle filters based on get log type
        function toggleGetLogFilters() {
            const logType = document.getElementById('getLogType').value;
            const navFilters = document.getElementById('navigationFilters');
            const userFilters = document.getElementById('userActivityFilters');
            
            if (logType === 'navigation') {
                navFilters.style.display = 'block';
                userFilters.style.display = 'none';
            } else if (logType === 'user_activity') {
                navFilters.style.display = 'none';
                userFilters.style.display = 'block';
            } else {
                navFilters.style.display = 'none';
                userFilters.style.display = 'none';
            }
        }
        
        // Create log form submission
        document.getElementById('createLogForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {};
            
            // Convert form data to object
            for (let [key, value] of formData.entries()) {
                if (value.trim() !== '') {
                    if (key === 'additionalData' && value.trim()) {
                        try {
                            data[key] = JSON.parse(value);
                        } catch (e) {
                            alert('Invalid JSON in Additional Data field');
                            return;
                        }
                    } else if (key === 'destinationReached') {
                        data[key] = value === 'true';
                    } else if (['startLatitude', 'startLongitude', 'endLatitude', 'endLongitude', 'routeDistance', 'estimatedDuration', 'navigationDuration'].includes(key)) {
                        data[key] = parseFloat(value);
                    } else {
                        data[key] = value;
                    }
                }
            }
            
            try {
                const response = await fetch(`${API_BASE}/create_log.php`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                displayResponse('createResponse', result, response.ok);
            } catch (error) {
                displayResponse('createResponse', { error: error.message }, false);
            }
        });
        
        // Get logs form submission
        document.getElementById('getLogsForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const params = new URLSearchParams();
            
            // Add all form data to params
            for (let [key, value] of formData.entries()) {
                if (value.trim() !== '') {
                    params.append(key, value);
                }
            }
            
            try {
                const response = await fetch(`${API_BASE}/get_logs.php?${params.toString()}`);
                const result = await response.json();
                displayResponse('getResponse', result, response.ok);
            } catch (error) {
                displayResponse('getResponse', { error: error.message }, false);
            }
        });
        
        // Display response
        function displayResponse(elementId, data, isSuccess) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `response ${isSuccess ? 'success' : 'error'}`;
            element.textContent = JSON.stringify(data, null, 2);
        }
        
        // Initialize
        document.getElementById('getLogType').addEventListener('change', toggleGetLogFilters);
        toggleLogTypeFields();
        toggleGetLogFilters();
    </script>
</body>
</html>

