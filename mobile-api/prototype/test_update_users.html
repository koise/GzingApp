<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Update Users API</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .demo-section {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        .form-group {
            margin: 10px 0;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .response {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
        .url { 
            font-family: monospace; 
            background: #e9ecef; 
            padding: 2px 6px; 
            border-radius: 3px; 
            color: #495057;
        }
        .success { border-left-color: #28a745; }
        .error { border-left-color: #dc3545; }
        .loading { border-left-color: #ffc107; }
        .user-display {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        .user-field {
            display: flex;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        .user-field:last-child {
            border-bottom: none;
        }
        .field-label {
            font-weight: bold;
            min-width: 120px;
            color: #495057;
        }
        .field-value {
            color: #212529;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚úèÔ∏è Test Update Users API</h1>
        <p>Test the updateUsers.php API for updating user information.</p>
        
        <div class="demo-section">
            <h3>üîç Step 1: Get User Data for Editing</h3>
            <div class="form-group">
                <label for="userId">User ID:</label>
                <input type="number" id="userId" placeholder="Enter User ID" value="9" min="1">
            </div>
            <button onclick="getUserForEdit()">Get User Data</button>
            <div id="getUserResult" class="response">Click "Get User Data" to fetch user information...</div>
        </div>
        
        <div class="demo-section">
            <h3>üë§ Current User Data</h3>
            <div id="userDisplay" class="user-display">
                <p style="text-align: center; color: #6c757d;">No user data loaded yet</p>
            </div>
        </div>
        
        <div class="demo-section">
            <h3>‚úèÔ∏è Step 2: Edit User Information</h3>
            <div class="form-group">
                <label for="editFirstName">First Name:</label>
                <input type="text" id="editFirstName" placeholder="First Name">
            </div>
            <div class="form-group">
                <label for="editLastName">Last Name:</label>
                <input type="text" id="editLastName" placeholder="Last Name">
            </div>
            <div class="form-group">
                <label for="editEmail">Email:</label>
                <input type="email" id="editEmail" placeholder="Email Address">
            </div>
            <div class="form-group">
                <label for="editUsername">Username:</label>
                <input type="text" id="editUsername" placeholder="Username (optional)">
            </div>
            <div class="form-group">
                <label for="editPhoneNumber">Phone Number:</label>
                <input type="tel" id="editPhoneNumber" placeholder="Phone Number (optional)">
            </div>
            <div class="form-group">
                <label for="editRole">Role:</label>
                <select id="editRole">
                    <option value="user">User</option>
                    <option value="admin">Admin</option>
                    <option value="moderator">Moderator</option>
                </select>
            </div>
            <button onclick="updateUser()">Update User</button>
            <button onclick="resetForm()">Reset Form</button>
            <div id="updateResult" class="response">Click "Update User" to save changes...</div>
        </div>
        
        <div class="demo-section">
            <h3>üîß API Details</h3>
            <p><strong>GET Endpoint:</strong> <span class="url">GET /updateUsers?id={user_id}</span></p>
            <p><strong>POST Endpoint:</strong> <span class="url">POST /updateUsers</span></p>
            <p><strong>Base URL:</strong> <span class="url">https://powderblue-pig-261057.hostingersite.com/mobile-api/prototype/</span></p>
            <p><strong>Database:</strong> <span class="url">u126959096_gzing_admin</span></p>
        </div>
    </div>

    <script>
        const baseUrl = 'https://powderblue-pig-261057.hostingersite.com/mobile-api/prototype/';
        let currentUser = null;
        
        async function getUserForEdit() {
            const userId = document.getElementById('userId').value;
            if (!userId) {
                showError('getUserResult', 'Please enter a user ID');
                return;
            }
            
            try {
                showLoading('getUserResult', `Fetching user ${userId} for editing...`);
                
                const response = await fetch(`${baseUrl}updateUsers?id=${userId}`);
                const data = await response.json();
                
                if (data.success) {
                    showSuccess('getUserResult', data.message);
                    currentUser = data.data.user;
                    displayUser(currentUser);
                    populateEditForm(currentUser);
                } else {
                    showError('getUserResult', data.message);
                }
                
            } catch (error) {
                showError('getUserResult', 'Network error: ' + error.message);
            }
        }
        
        async function updateUser() {
            if (!currentUser) {
                showError('updateResult', 'Please get user data first');
                return;
            }
            
            const updateData = {
                user_id: currentUser.id,
                first_name: document.getElementById('editFirstName').value.trim(),
                last_name: document.getElementById('editLastName').value.trim(),
                email: document.getElementById('editEmail').value.trim(),
                username: document.getElementById('editUsername').value.trim() || null,
                phone_number: document.getElementById('editPhoneNumber').value.trim() || null,
                role: document.getElementById('editRole').value
            };
            
            // Validate required fields
            if (!updateData.first_name || !updateData.last_name || !updateData.email) {
                showError('updateResult', 'Please fill in all required fields (First Name, Last Name, Email)');
                return;
            }
            
            try {
                showLoading('updateResult', 'Updating user...');
                
                const response = await fetch(`${baseUrl}updateUsers`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updateData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showSuccess('updateResult', data.message);
                    currentUser = data.data.user;
                    displayUser(currentUser);
                } else {
                    showError('updateResult', data.message);
                }
                
            } catch (error) {
                showError('updateResult', 'Network error: ' + error.message);
            }
        }
        
        function displayUser(user) {
            const userDisplay = document.getElementById('userDisplay');
            
            if (!user) {
                userDisplay.innerHTML = '<p style="text-align: center; color: #dc3545;">No user data to display</p>';
                return;
            }
            
            userDisplay.innerHTML = `
                <h4>üë§ ${user.first_name} ${user.last_name}</h4>
                <div class="user-field">
                    <span class="field-label">ID:</span>
                    <span class="field-value">${user.id}</span>
                </div>
                <div class="user-field">
                    <span class="field-label">Email:</span>
                    <span class="field-value">${user.email}</span>
                </div>
                <div class="user-field">
                    <span class="field-label">Username:</span>
                    <span class="field-value">${user.username || 'Not set'}</span>
                </div>
                <div class="user-field">
                    <span class="field-label">Phone:</span>
                    <span class="field-value">${user.phone_number || 'Not set'}</span>
                </div>
                <div class="user-field">
                    <span class="field-label">Role:</span>
                    <span class="field-value">${user.role}</span>
                </div>
                <div class="user-field">
                    <span class="field-label">Status:</span>
                    <span class="field-value">${user.status}</span>
                </div>
                <div class="user-field">
                    <span class="field-label">Updated:</span>
                    <span class="field-value">${user.updated_at}</span>
                </div>
            `;
        }
        
        function populateEditForm(user) {
            document.getElementById('editFirstName').value = user.first_name || '';
            document.getElementById('editLastName').value = user.last_name || '';
            document.getElementById('editEmail').value = user.email || '';
            document.getElementById('editUsername').value = user.username || '';
            document.getElementById('editPhoneNumber').value = user.phone_number || '';
            document.getElementById('editRole').value = user.role || 'user';
        }
        
        function resetForm() {
            if (currentUser) {
                populateEditForm(currentUser);
            } else {
                document.getElementById('editFirstName').value = '';
                document.getElementById('editLastName').value = '';
                document.getElementById('editEmail').value = '';
                document.getElementById('editUsername').value = '';
                document.getElementById('editPhoneNumber').value = '';
                document.getElementById('editRole').value = 'user';
            }
        }
        
        function showLoading(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.parentElement.className = 'demo-section loading';
        }
        
        function showSuccess(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = `‚úÖ ${message}`;
            element.parentElement.className = 'demo-section success';
        }
        
        function showError(elementId, message) {
            const element = document.getElementById(elementId);
            element.textContent = `‚ùå ${message}`;
            element.parentElement.className = 'demo-section error';
        }
        
        // Auto-load user 9 on page load
        window.onload = function() {
            getUserForEdit();
        };
    </script>
</body>
</html>

